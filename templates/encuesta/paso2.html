{% load static %}

<style>
    .card-onboarding {
        border: none !important;
        border-radius: 35px !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5) !important;
        max-width: 420px;
        width: 100%;
        height: 550px;
        background-color: var(--bg-content) !important;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        animation: slideInRight 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .onboarding-body {
        flex: 1;
        overflow-y: auto;
        padding: 1rem 1.5rem;
        scrollbar-width: none;
    }

    .onboarding-body::-webkit-scrollbar {
        display: none;
    }

    .onboarding-footer {
        padding: 1.5rem 2rem;
        background-color: var(--bg-content);
        border-top: 1px solid rgba(0, 0, 0, 0.05);
    }

    .btn-nunut {
        background-color: #85c81a !important;
        color: white !important;
        border: none !important;
        border-radius: 20px !important;
        padding: 16px !important;
        font-weight: 800 !important;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        text-decoration: none !important;
    }

    .btn-nunut:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(133, 200, 26, 0.3) !important;
        color: white !important;
    }

    .metric-card {
        background: rgba(0, 0, 0, 0.03);
        border-radius: 20px;
        padding: 1.25rem;
        margin-bottom: 1rem;
    }

    .dark-mode .metric-card {
        background: rgba(255, 255, 255, 0.05);
    }

    .activity-radio input:checked+.activity-box {
        border-color: #85c81a !important;
        background-color: rgba(132, 199, 26, 0.1) !important;
        color: #85c81a !important;
    }

    .goal-option input:checked+.goal-content {
        border: 2px solid #85c81a !important;
        background-color: rgba(132, 199, 26, 0.05) !important;
    }
</style>

<div class="card card-onboarding">
    <div class="px-4 pt-4 pb-2">
        <div class="d-flex align-items-center mb-3">
            <button hx-get="{% url 'base:guardar_paso' 1 %}" hx-target="#onboarding-container" class="btn-back">
                <span class="material-symbols-outlined">chevron_left</span>
            </button>
            <h6 class="flex-grow-1 text-center mb-0 fw-bold text-muted pe-4">PASO 2 DE 4</h6>
        </div>
        <div class="progress" style="height: 6px; border-radius: 10px; background: rgba(0,0,0,0.05);">
            <div class="progress-bar" style="width: 50%; background: #85c81a; transition: width 0.5s ease;"></div>
        </div>
    </div>

    <form id="step-form" hx-post="{% url 'base:guardar_paso' 2 %}" hx-target="#onboarding-container"
        class="onboarding-body">
        {% csrf_token %}

        {% if form.errors %}
        <div class="alert alert-danger py-2 small" style="border-radius: 15px;">
            <i class="fas fa-exclamation-circle me-1"></i> Por favor revisa los datos.
        </div>
        {% endif %}

        <div class="text-center mb-1">
            <h3 class="fw-black mb-1">Tu Cuerpo</h3>
            <p class="text-muted small">MÃ©tricas necesarias para tu plan.</p>
        </div>

        <div class="metric-card">
            <div class="d-flex justify-content-between mb-2">
                <span class="small fw-bold">Altura</span>
                <span class="text-primary fw-black"><span id="h-val">175</span> cm</span>
            </div>
            <input type="range" name="altura" class="form-range" min="120" max="220" value="175"
                oninput="document.getElementById('h-val').innerText=this.value">
        </div>

        <div class="metric-card">
            <div class="d-flex justify-content-between mb-2">
                <span class="small fw-bold">Peso</span>
                <span class="text-primary fw-black"><span id="w-val">70</span> kg</span>
            </div>
            <input type="range" name="peso" class="form-range" min="40" max="150" value="70"
                oninput="document.getElementById('w-val').innerText=this.value">
        </div>

        <p class="small fw-bold text-uppercase text-muted mb-2 text-center">Actividad Diaria</p>
        <div class="row g-2 mb-3">
            {% for val, label, icon in niveles_actividad %}
            <div class="col-3 activity-radio">
                <label class="w-100 cursor-pointer">
                    {% if forloop.first %}
                    <input type="radio" name="nivel_actividad" value="{{ val }}" class="d-none" checked>
                    {% else %}
                    <input type="radio" name="nivel_actividad" value="{{ val }}" class="d-none">
                    {% endif %}
                    <div class="activity-box p-2 border rounded-4 text-center transition-all">
                        <span class="material-symbols-outlined d-block">{{ icon }}</span>
                        <span style="font-size: 9px;" class="fw-bold">{{ label }}</span>
                    </div>
                </label>
            </div>
            {% endfor %}
        </div>

        <p class="small fw-bold text-uppercase text-muted mb-2 text-center">Tu Objetivo</p>
        <div class="space-y-2 mb-3">
            {% for val, titulo, desc, icon, color_class in objetivos %}
            <label class="w-100 goal-option mb-2 cursor-pointer">
                {% if forloop.first %}
                <input type="radio" name="objetivo" value="{{ val }}" class="d-none" checked>
                {% else %}
                <input type="radio" name="objetivo" value="{{ val }}" class="d-none">
                {% endif %}
                <div
                    class="goal-content d-flex align-items-center p-3 border rounded-4 transition-all bg-white dark:bg-white/5">
                    <div class="rounded-3 {{ color_class }} p-2 me-3">
                        <span class="material-symbols-outlined">{{ icon }}</span>
                    </div>
                    <div class="flex-grow-1">
                        <p class="mb-0 fw-bold small">{{ titulo }}</p>
                        <p class="mb-0 text-muted" style="font-size: 10px;">{{ desc }}</p>
                    </div>
                </div>
            </label>
            {% endfor %}
        </div>

        <div class="mt-3">
            <button type="submit" class="btn-nunut shadow-lg">
                <span>Continuar</span>
                <i class="fas fa-arrow-right ms-2"></i>
            </button>
        </div>
    </form>
</div>